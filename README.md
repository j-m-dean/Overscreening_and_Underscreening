# Data  for &ldquo;Overscreening and Underscreening in Solid-Electrolyte Grain Boundary Space-Charge Layers&rdquo;
Authors:
- Jacob M. Dean ORCID [0000-0003-3363-4256](https://orcid.org/0000-0003-3363-4256)
## Summary
This repository contains all the time-averaged distributions of every kinetic Monte Carlo simulation conducted for the paper, and all the analysis required to make the figures for the paper. In addition, corner plots for each parameter set and all values of evidence and Bayes factors are provided.
To run the complete data analysis, run the following commands from the kmc_paper_data directory:
```
pip install -r requirements.txt
snakemake clear
snakemake --cores all
```
Note however, that depending on the number of cores devoted to calculating the analysis, this could take anywhere between several hours and a day.
## Contents:
- `README.md`: This file.
- `kmc_paper_data/requirements.txt`: Python dependencies.
- `kmc_paper_data/Snakefile`: The top-level `snakemake` analysis workflow script.
- `kmc_paper_data/Figures`: Manuscript figures generated by running the analysis workflow.
- `kmc_paper_data/simulation_data/`: All the average occupancies from each simulation.
- `kmc_paper_data/averaged_distribution`: The averaged distributions and associated errors for each parameter set.
- `kmc_paper_data/charges_105`: The results for a system with 105 charges.
- `kmc_paper_data/charges_210`: The results for a system with 210 charges.
- `kmc_paper_data/charges_421`: The results for a system with 421 charges.
- `kmc_paper_data/charges_2109`: The results for a system with 2109 charges.
- `kmc_paper_data/make_inputs`: Files required to make input files for uravu analysis.
- `kmc_paper_data/paths`: The relative paths required to make the average distributions for each parameter set.
- `kmc_paper_data/uravu_analysis_scripts`: The analysis scripts for the Bayesian analysis.
- `kmc_paper_data/bayes_and_evidence.py`: Script that extracts Bayes factors and evidence values.
- `kmc_paper_data/evidence_and_bayes.csv`: Tabulated evidence and Bayes factor values.
- `kmc_paper_data/extract_average_distributions.py`: Script that extracts averaged distributions from simulated results.
- `kmc_paper_data/nu_analysis_results.json`: the results of the uravu nu analysis.
- `kmc_paper_data/overscreening_figure.py`: Script to produce the overscreening figures.
- `kmc_paper_data/underscreening_figures.py`: Script to produce the underscreening figures.
## Data processing workflow
Data processing is mostly managed using [`snakemake`](https://snakemake.readthedocs.io), and uses the scripts in the `kmc_paper_data` directory. The full data analysis workflow can be rerun with:
```
snakemake --cores all clear
snakemake --cores all
```

## Overview of the full data workflow

Kinetic Monte Carlo simulations returned a `kmc_output.json` file containing the simulation trajectory (these files are not made available in this repository due the large size of the files). From the simulation trajectory a time-averaged distribution of charges is calculated as an array of length 75, and stored in an `average_occupancy.json` file for each individual simulation trajectory. These `average_occupancy.json` files are stored in the `kmc_paper_data/simulation_data` directory. From these `average_occupacy.json` files we calculate the average half space-charge distribution (assuming a symmetric distribution around the grain boundary). These average half space-charge distributions, along with associated errors for each distance from the grain boundary, are stored in the `kmc_paper_data/averaged_distributions` directory. These averaged half space-charge distributions and associated standard error values are used as inputs into uravu to conduct Bayesian analysis. The Bayesian analysis returns distributions for each parameter of both models (the oscillatory and purely exponential model). These outputs are stored in `kmc_paper_data/charges_X/permittivity_Y/outputs.json` directories, where X = (number of charges) and Y = (relative permittivity). Corner plots of these distributions are stored in the same location. The maximum likelihood parameter and 95% confidence interval are used to plot Fig. 3. The full distributions of the appropriate alpha parameter are used to calculate the value of nu. The results of the nu analysis are stored in the `nu_analysis_results.json` file.  
